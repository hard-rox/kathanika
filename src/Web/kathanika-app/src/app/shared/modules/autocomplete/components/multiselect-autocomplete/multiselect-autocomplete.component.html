<!-- <pre>{{options.length | json}}</pre> -->

<div class="flex flex-col">
  <label [for]="control?.name+'-search'">
    {{label}}
    <span *ngIf="isRequired()" class="text-theme-fire-red">*</span>
  </label>

  <div class="flex justify-start flex-wrap gap-1 mb-1">
    <span *ngFor="let item of selectedOptions" class="inline-flex items-center px-2 py-1 bg-theme-silver">
      <span [innerHTML]="item.content?.outerHTML"></span>
      <button type="button" (click)="removeSelection(item)"
        class="inline-flex items-center p-1 ml-2 text-sm bg-theme-davys-gray text-white hover:bg-theme-gunmetal active:bg-theme-rich-black">
        <svg class="w-2 h-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
        </svg>
      </button>
    </span>
  </div>

  <div class="group relative">
    <input type="text" autocomplete="off" [id]="control?.name+'-search'" [(ngModel)]="searchInputValue"
      (input)="onInputChange()" [placeholder]="placeholder.length > 0? placeholder : label" [disabled]="isDisabled"
      (blur)="onBlur()" [ngClass]="(control?.dirty || control?.touched)
  && !control?.valid ?
  'border-theme-fire-red placeholder:text-theme-fire-red placeholder:text-opacity-30'
  : isDisabled ? 'border-theme-davys-gray border-opacity-50 bg-gray-200': 'border-theme-gunmetal'"
      class="peer w-full" />
    <div tabindex="0" *ngIf="options && options.length > 0"
      class="z-10 w-full border bg-white invisible shadow-md absolute top-12 transition-all opacity-0 flex flex-col group-focus-within:visible group-focus-within:opacity-100 group-focus-within:translate-y-1">
      <ng-content select="kn-autocomplete-option"></ng-content>
    </div>
  </div>
  <ul class="list-disc ml-4">
    <li *ngIf="(control?.dirty || control?.touched)
    && control?.hasError('required')" class="text-theme-fire-red">{{label}} is
      required</li>
  </ul>
</div>
